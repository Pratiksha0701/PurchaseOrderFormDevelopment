<div class="container mt-5">
  <h2 class="text-center">Purchase Order Form</h2>
  <form [formGroup]="poForm" (ngSubmit)="submitForm()" novalidate>
    <!-- Purchase Order Details -->
    <div class="section">
      <h3>Purchase Order Details</h3>
      <div class="form-row">
        <div class="form-group col-md-3">
          <label for="clientName">Client Name <span class="text-danger">*</span></label>
          <select id="clientName" formControlName="clientName" class="form-control">
            <option *ngFor="let client of clients" [value]="client">{{client}}</option>
          </select>
          <div *ngIf="poForm.get('clientName')?.touched && poForm.get('clientName')?.invalid" class="text-danger">Client Name is required.</div>
        </div>
        <div class="form-group col-md-3">
          <label for="poType">Purchase Order Type <span class="text-danger">*</span></label>
          <select id="poType" formControlName="poType" class="form-control">
            <option value="Group PO">Group PO</option>
            <option value="Individual PO">Individual PO</option>
          </select>
          <div *ngIf="poForm.get('poType')?.touched && poForm.get('poType')?.invalid" class="text-danger">Purchase Order Type is required.</div>
        </div>
        <div class="form-group col-md-3">
          <label for="poNumber">Purchase Order No. <span class="text-danger">*</span></label>
          <input type="text" id="poNumber" formControlName="poNumber" class="form-control">
          <div *ngIf="poForm.get('poNumber')?.touched && poForm.get('poNumber')?.invalid" class="text-danger">
            <div *ngIf="poForm.get('poNumber')?.errors?.required">Purchase Order No. is required.</div>
            <div *ngIf="poForm.get('poNumber')?.errors?.pattern">Invalid format.</div>
          </div>
        </div>
        <div class="form-group col-md-3">
          <label for="receivedOn">Received On <span class="text-danger">*</span></label>
          <input type="date" id="receivedOn" formControlName="receivedOn" class="form-control">
          <div *ngIf="poForm.get('receivedOn')?.touched && poForm.get('receivedOn')?.invalid" class="text-danger">Received On is required.</div>
        </div>
      </div>
      <div class="form-row">
        <div class="form-group col-md-3">
          <label for="receivedFromName">Received From Name <span class="text-danger">*</span></label>
          <input type="text" id="receivedFromName" formControlName="receivedFromName" class="form-control">
          <div *ngIf="poForm.get('receivedFromName')?.touched && poForm.get('receivedFromName')?.invalid" class="text-danger">Received From Name is required.</div>
        </div>
        <div class="form-group col-md-3">
          <label for="receivedFromEmail">Received From Email ID <span class="text-danger">*</span></label>
          <input type="email" id="receivedFromEmail" formControlName="receivedFromEmail" class="form-control">
          <div *ngIf="poForm.get('receivedFromEmail')?.touched && poForm.get('receivedFromEmail')?.invalid" class="text-danger">Valid Email ID is required.</div>
        </div>
        <div class="form-group col-md-3">
          <label for="poStartDate">PO Start Date <span class="text-danger">*</span></label>
          <input type="date" id="poStartDate" formControlName="poStartDate" class="form-control">
          <div *ngIf="poForm.get('poStartDate')?.touched && poForm.get('poStartDate')?.invalid" class="text-danger">PO Start Date is required.</div>
        </div>
        <div class="form-group col-md-3">
          <label for="poEndDate">PO End Date <span class="text-danger">*</span></label>
          <input type="date" id="poEndDate" formControlName="poEndDate" class="form-control">
          <div *ngIf="poForm.get('poEndDate')?.touched && poForm.get('poEndDate')?.invalid" class="text-danger">PO End Date is required and should be after Start Date.</div>
        </div>
      </div>
      <div class="form-row">
        <div class="form-group col-md-3">
          <label for="budget">Budget <span class="text-danger">*</span></label>
          <input type="number" id="budget" formControlName="budget" class="form-control">
          <div *ngIf="poForm.get('budget')?.touched && poForm.get('budget')?.invalid" class="text-danger">Budget is required and should be a number up to 5 digits.</div>
        </div>
        <div class="form-group col-md-3">
          <label for="currency">Currency <span class="text-danger">*</span></label>
          <select id="currency" formControlName="currency" class="form-control">
            <option *ngFor="let currency of currencies" [value]="currency">{{currency}}</option>
          </select>
          <div *ngIf="poForm.get('currency')?.touched && poForm.get('currency')?.invalid" class="text-danger">Currency is required.</div>
        </div>
      </div>
    </div>

    <!-- Talent Details -->
    <div class="section">
      <h3>Talent Details</h3>
      <div class="form-group">
        <label for="jobTitleReqName">Job Title/REQ Name <span class="text-danger">*</span></label>
        <select id="jobTitleReqName" formControlName="jobTitleReqName" class="form-control">
          <option *ngFor="let job of jobs" [value]="job">{{job}}</option>
        </select>
        <div *ngIf="poForm.get('jobTitleReqName')?.touched && poForm.get('jobTitleReqName')?.invalid" class="text-danger">Job Title/REQ Name is required.</div>
      </div>
      <div class="form-group">
        <label for="reqId">REQ ID/Assignment ID <span class="text-danger">*</span></label>
        <input type="text" id="reqId" formControlName="reqId" class="form-control" readonly>
      </div>
      <div formArrayName="talents">
        <div *ngFor="let talent of talentsArray.controls; let i = index" [formGroupName]="i">
          <div class="custom-control custom-checkbox">
            <input type="checkbox" class="custom-control-input" [id]="'talent' + i" formControlName="selected">
            <label class="custom-control-label" [for]="'talent' + i">{{talent.get('name')?.value}}</label>
          </div>
          <div *ngIf="talent.get('selected')?.value" class="mt-2">
            <div class="form-row">
              <div class="form-group col-md-4">
                <label>Contract Duration</label>
                <input type="text" class="form-control" formControlName="contractDuration" placeholder="Contract Duration">
              </div>
              <div class="form-group col-md-4">
                <label>Bill Rate</label>
                <input type="text" class="form-control" formControlName="billRate" placeholder="Bill Rate">
              </div>
              <div class="form-group col-md-4">
                <label>Currency</label>
                <select class="form-control" formControlName="currency">
                  <option *ngFor="let currency of currencies" [value]="currency">{{currency}}</option>
                </select>
              </div>
            </div>
            <div class="form-row">
              <div class="form-group col-md-4">
                <label>Std. Time BR</label>
                <input type="text" class="form-control" formControlName="stdTimeBR" placeholder="Std. Time BR">
              </div>
              <div class="form-group col-md-4">
                <label>Over Time BR</label>
                <input type="text" class="form-control" formControlName="overTimeBR" placeholder="Over Time BR">
              </div>
            </div>
          </div>
        </div>
      </div>
      <button type="button" class="btn btn-primary" (click)="addTalent()">Add Another</button>
    </div>

    <div class="form-group">
      <button type="reset" class="btn btn-secondary" (click)="resetForm()">Reset</button>
      <button type="submit" class="btn btn-success" [disabled]="poForm.invalid">Save</button>
    </div>
  </form>
</div>
